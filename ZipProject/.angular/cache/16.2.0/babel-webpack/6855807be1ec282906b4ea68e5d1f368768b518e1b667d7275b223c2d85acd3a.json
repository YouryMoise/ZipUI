{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/macse/Downloads/ZipProject/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _class;\nimport { EventEmitter } from '@angular/core';\nimport { utils, write, writeFile } from 'xlsx';\nimport { saveAs } from \"file-saver\";\nimport { firstValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\n//import {google} from \"googleapis\";\nexport class FileSelectComponent {\n  constructor(http) {\n    this.http = http;\n    this.sendValue = new EventEmitter();\n    //d = new Map<string, string>();\n    this.all_tags = [\"Piggy\", \"Yoga\", \"PAWS\", \"Dirt\", \"Lighthouse\", \"Art\", \"Block\", \"Storytime\", \"Scavenger\", \"Smoke\", \"Underliner\", \"Colors\", \"Com\", \"Shen\", \"Gratitude\", \"Seuss\", \"Fam\", \"Marcus\", \"Zumba\", \"Cage\", \"Cinderfit\", \"Walk4\", \"Cocktails\", \"Not\", \"Global\", \"GMD\", \"Jr\", \"Halloween\", \"Typoe\", \"Bootleg\", \"MLK\", \"Public\"];\n  }\n  ngOnInit() {\n    //this.createExcelFile();\n    if (this.functionName == 'Counter') {\n      this.count();\n    }\n    if (this.functionName == 'Converter') {\n      //read the first column for zip codes \n      //this.createExcelFile()\n      this.convert();\n    }\n  }\n  createExcelFile(allZipCodes, dictionary) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var wb = utils.book_new();\n      wb.Props = {\n        Title: \"SheetJS Tutorial\",\n        Subject: \"Test\",\n        Author: \"Red Stapler\",\n        CreatedDate: new Date(2017, 12, 19)\n      };\n      wb.SheetNames.push(\"Test Sheet\");\n      //var ws_data = [['hello' , 'world']]; one row with 2 cells\n      var ws_data = [[\" \", \"Latitude\", \"Longitude\", ..._this.all_tags]];\n      //part to add the other rows\n      //console.log(dictionary.get(\"Piggy\")?.get(\"33162\"))\n      for (let i = 0; i < allZipCodes.length; i++) {\n        let temp = [];\n        temp.push(allZipCodes[i]);\n        for (let j = 0; j < _this.all_tags.length; j++) {\n          if (dictionary.get(_this.all_tags[j])?.get(allZipCodes[i])) {\n            temp.push(dictionary.get(_this.all_tags[j])?.get(allZipCodes[i]));\n          } else {\n            temp.push(0);\n          }\n        }\n        if (temp != undefined && temp.length > 1) {\n          ws_data.push(temp);\n        }\n      }\n      for (let k = 1; k < ws_data.length; k++) {\n        /* (await firstValueFrom(this.http.get<Observable<any>>(\n          `https://maps.googleapis.com/maps/api/geocode/json?components=country:US|postal_code:${ws_data[k][0]}&key=AIzaSyDmVrgNrMs_hq6tXpXkiqFYb1LRSf9gdxs`\n        ))).subscribe(\n          (data) => {\n            let result = data as unknown as Result\n            ws_data[k].splice(1,0,`${result.results[0].geometry.location.lat} ${result.results[0].geometry.location.lng}`)\n            //temp.push(result.results[0].address_components[0].long_name)\n            ////console.log(result.results[0].geometry.location.lat)\n            //console.log(result.results[0].geometry.location.lng)\n                     }\n            ) */\n        console.log(\"in here\");\n        console.log(ws_data[k]);\n        let temp2 = yield firstValueFrom(_this.http.get(`https://maps.googleapis.com/maps/api/geocode/json?components=country:US|postal_code:${ws_data[k][0]}&key=AIzaSyDmVrgNrMs_hq6tXpXkiqFYb1LRSf9gdxs`));\n        ////console.log(\"5pm\")\n        //if(k == ws_data.length-1) {\n        ////console.log(temp2.results[0].geometry.location)\n        ////console.log(temp2) \n        if (temp2.status != 'ZERO_RESULTS') {\n          ws_data[k].splice(1, 0, `${temp2.results[0].geometry.location.lat}`);\n          ws_data[k].splice(2, 0, `${temp2.results[0].geometry.location.lng}`);\n        } else {\n          ws_data[k].splice(1, 0, \"Not found\");\n          ws_data[k].splice(2, 0, \"Not found\");\n        }\n      }\n      ////console.log(\"outside loop now\")\n      //will need an array for each zip code\n      //to make each array, will need to create [], then push\n      //zip code, then push dict.get(tag).get(zip) for every tag\n      var ws = utils.aoa_to_sheet(ws_data);\n      wb.Sheets[\"Test Sheet\"] = ws;\n      var wbout = write(wb, {\n        bookType: 'xlsx',\n        type: 'binary'\n      });\n      function s2ab(s) {\n        var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer\n        var view = new Uint8Array(buf); //create uint8array as viewer\n        for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet\n        return buf;\n      }\n      saveAs(new Blob([s2ab(wbout)], {\n        type: \"application/octet-stream\"\n      }), `${_this.fileName}.xlsx`);\n    })();\n  }\n  testFunction(mapping) {\n    this.sendValue.emit(mapping);\n  }\n  zipIsBad(word) {\n    /*Bad if\n    No Dash:\n    Not 5 characters\n    Not numeric\n    \n    With Dash:\n    Not 5 characters before and after dash\n    \n    */\n    if (word.includes(\"-\")) {\n      let dashIndex = word.indexOf(\"-\");\n      let firstPart = word.substring(0, dashIndex);\n      let secondPart = word.substring(dashIndex + 1);\n      if (firstPart.length != 5 || secondPart.length != 5 || Number.isNaN(Number(firstPart)) || Number.isNaN(Number(secondPart))) {\n        return false;\n      }\n      return true;\n    }\n    if (Number.isNaN(Number(word)) || word.length != 5) {\n      return false;\n    }\n    return true;\n  }\n  /* async callCountWait(){\n    //console.log(\"In here\")\n    await this.callCountAsync();\n    //console.log(this.d)\n  } */\n  callCountAsync() {\n    return new Promise(() => this.count());\n  }\n  csvExport(file) {\n    const headings = [['Col1', 'Col2', 'Col3']];\n    const wb = utils.book_new();\n    const ws = utils.json_to_sheet([]);\n    utils.sheet_add_aoa(ws, headings);\n    utils.sheet_add_json(ws, file, {\n      origin: 'A2',\n      skipHeader: true\n    });\n    utils.book_append_sheet(wb, ws, 'Users');\n    writeFile(wb, 'Users Report.xlsx');\n  }\n  convert() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      //need all the zip codes\n      console.log(_this2.fileJSON);\n      console.log(typeof _this2.fileJSON[0]);\n      console.log(Array(_this2.fileJSON[0]));\n      for (let i = 0; i < _this2.fileJSON.length; i++) {\n        let temp2 = yield firstValueFrom(_this2.http.get(`https://maps.googleapis.com/maps/api/geocode/json?components=country:US|postal_code:${_this2.fileJSON[i][' ']}&key=AIzaSyDmVrgNrMs_hq6tXpXkiqFYb1LRSf9gdxs`));\n        let latitude = 'NA';\n        let longitude = 'NA';\n        if (temp2.status != 'ZERO_RESULTS') {\n          latitude = temp2.results[0].geometry.location.lat;\n          longitude = temp2.results[0].geometry.location.lng;\n        }\n        let temp = {\n          ZIP: _this2.fileJSON[i][' '],\n          Latitude: latitude,\n          Longitude: longitude,\n          Piggy: _this2.fileJSON[i]['Piggy'],\n          Yoga: _this2.fileJSON[i]['Yoga'],\n          PAWS: _this2.fileJSON[i]['PAWS'],\n          Dirt: _this2.fileJSON[i]['Dirt'],\n          Lighthouse: _this2.fileJSON[i]['Lighthouse'],\n          Art: _this2.fileJSON[i]['Art'],\n          Block: _this2.fileJSON[i]['Block'],\n          Storytime: _this2.fileJSON[i]['Storytime'],\n          Scavenger: _this2.fileJSON[i]['Scavenger'],\n          Smoke: _this2.fileJSON[i]['Smoke'],\n          Underliner: _this2.fileJSON[i]['Underliner'],\n          Colors: _this2.fileJSON[i]['Colors'],\n          Com: _this2.fileJSON[i]['Com'],\n          Shen: _this2.fileJSON[i]['Shen'],\n          Gratitude: _this2.fileJSON[i]['Gratitude'],\n          Seuss: _this2.fileJSON[i]['Seuss'],\n          Fam: _this2.fileJSON[i]['Fam'],\n          Marcus: _this2.fileJSON[i]['Marcus'],\n          Zumba: _this2.fileJSON[i]['Zumba'],\n          Cage: _this2.fileJSON[i]['Cage'],\n          Cinderfit: _this2.fileJSON[i]['Cinderfit'],\n          Walk4: _this2.fileJSON[i]['Walk4'],\n          Cocktails: _this2.fileJSON[i]['Cocktails'],\n          Not: _this2.fileJSON[i]['Not'],\n          Global: _this2.fileJSON[i]['Global'],\n          GMD: _this2.fileJSON[i]['GMD'],\n          Jr: _this2.fileJSON[i]['Jr'],\n          Halloween: _this2.fileJSON[i]['Halloween'],\n          Typoe: _this2.fileJSON[i]['Typoe'],\n          Bootleg: _this2.fileJSON[i]['Bootleg'],\n          MLK: _this2.fileJSON[i]['MLK'],\n          Public: _this2.fileJSON[i]['Public']\n        };\n        _this2.fileJSON[i] = temp;\n      }\n      let worksheet = utils.json_to_sheet(_this2.fileJSON);\n      let workbook = utils.book_new();\n      utils.book_append_sheet(workbook, worksheet);\n      writeFile(workbook, `${_this2.fileName}.xlsx`);\n      console.log(_this2.fileJSON);\n      /* let allZipCodes:string[] = []\n      for(let i =0; i<this.fileJSON.length;i++){\n        if(!allZipCodes.includes(this.fileJSON[i][' '])){\n        allZipCodes.push(this.fileJSON[i][' '])\n        }\n      }\n      //need to make a dictionary from cells\n      //(0 if undefined)\n      let d = new Map<string, Map<string, number>>()\n      let m;\n      for(let j = 0;j<this.all_tags.length;j++){\n        m = new Map<string, number>()\n        ////console.log(this.all_tags.length)\n        for(let k = 0;k<allZipCodes.length;k++){\n          m.set(String(this.fileJSON[k]['ZIP']), 0)\n        }\n      \n        d.set(this.all_tags[j], m)\n      }   */\n    })();\n  }\n\n  count() {\n    /*\n    Need to change\n    Right now, Zips only appear if >=1\n    Need the 0s as well\n    When starting, loop through whole file to\n    get all zip codes, create a list of that\n    and reference it in this function\n    (loop over that list instead of doing\n      .get().get())\n    \n    */\n    /*\n    Have a list of visited tags\n    For every item in the JSON file\n    If the tag-ZIP pair is already in visited, increase by 1\n    Otherwise, set to 1\n    \n    */\n    //currently creates dictionary of dictionaries\n    //Tag: <ZIP:number of tag-zip occurrences>\n    //still need to make it skip undefined zip codes\n    //all the tags from the MasterList\n    //Piggy,Yoga,PAWS,Dirt,Lighthouse,Art,Block,Storytime,Scavenger,Smoke,\n    //Underliner,Colors,Com,Shen,Gratitude,Seuss,Fam,Marcus,Zumba,Cage,Cinderfit,Walk4,\n    //Cocktails,Not,Global,GMD,Jr,Halloween,Typoe,Bootleg,MLK,Public\n    let allZipCodes = [];\n    for (let i = 0; i < this.fileJSON.length; i++) {\n      if (allZipCodes.includes(String(this.fileJSON[i]['ZIP']))) {\n        continue;\n      }\n      //console.log(this.fileJSON[i]['ZIP'])\n      allZipCodes.push(String(this.fileJSON[i]['ZIP']));\n    }\n    //initialize everything in d here\n    let d = new Map();\n    let m;\n    for (let j = 0; j < this.all_tags.length; j++) {\n      m = new Map();\n      ////console.log(this.all_tags.length)\n      for (let k = 0; k < allZipCodes.length; k++) {\n        m.set(String(this.fileJSON[k]['ZIP']), 0);\n      }\n      d.set(this.all_tags[j], m);\n    }\n    ////console.log(d)\n    let visited = [];\n    let currentNumber;\n    let current_tag;\n    for (let i = 0; i < this.fileJSON.length; i++) {\n      ////console.log(this.fileJSON[i]['Tag'])\n      if (typeof this.fileJSON[i].Tag === 'string') {\n        let result = this.all_tags.filter(word => this.fileJSON[i]['Tag'].includes(word));\n        //add a result[0] and if result.length here\n        if (result.length) {\n          current_tag = result[0];\n          currentNumber = d.get(current_tag)?.get(String(this.fileJSON[i]['ZIP']));\n          ////console.log(currentNumber)\n          if (currentNumber !== undefined) {\n            d.get(current_tag)?.set(String(this.fileJSON[i]['ZIP']), currentNumber + 1);\n          }\n        }\n      }\n    }\n    this.createExcelFile(allZipCodes, d);\n    //this.testFunction(d)\n    //this.csvExport(d)\n  }\n}\n_class = FileSelectComponent;\n_class.ɵfac = function FileSelectComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.HttpClient));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-file-select\"]],\n  inputs: {\n    fileJSON: \"fileJSON\",\n    chosenFunction: \"chosenFunction\",\n    fileName: \"fileName\",\n    functionName: \"functionName\"\n  },\n  outputs: {\n    sendValue: \"sendValue\"\n  },\n  decls: 2,\n  vars: 0,\n  consts: [[1, \"text-red-50\"]],\n  template: function FileSelectComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"p\", 0);\n      i0.ɵɵtext(1, \"Hello\");\n      i0.ɵɵelementEnd();\n    }\n  },\n  styles: [\"/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJmaWxlLXNlbGVjdC5jb21wb25lbnQuc2NzcyJ9 */\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmlsZS1zZWxlY3QvZmlsZS1zZWxlY3QuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLHdLQUF3SyIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["EventEmitter","utils","write","writeFile","saveAs","firstValueFrom","FileSelectComponent","constructor","http","sendValue","all_tags","ngOnInit","functionName","count","convert","createExcelFile","allZipCodes","dictionary","_this","_asyncToGenerator","wb","book_new","Props","Title","Subject","Author","CreatedDate","Date","SheetNames","push","ws_data","i","length","temp","j","get","undefined","k","console","log","temp2","status","splice","results","geometry","location","lat","lng","ws","aoa_to_sheet","Sheets","wbout","bookType","type","s2ab","s","buf","ArrayBuffer","view","Uint8Array","charCodeAt","Blob","fileName","testFunction","mapping","emit","zipIsBad","word","includes","dashIndex","indexOf","firstPart","substring","secondPart","Number","isNaN","callCountAsync","Promise","csvExport","file","headings","json_to_sheet","sheet_add_aoa","sheet_add_json","origin","skipHeader","book_append_sheet","_this2","fileJSON","Array","latitude","longitude","ZIP","Latitude","Longitude","Piggy","Yoga","PAWS","Dirt","Lighthouse","Art","Block","Storytime","Scavenger","Smoke","Underliner","Colors","Com","Shen","Gratitude","Seuss","Fam","Marcus","Zumba","Cage","Cinderfit","Walk4","Cocktails","Not","Global","GMD","Jr","Halloween","Typoe","Bootleg","MLK","Public","worksheet","workbook","String","d","Map","m","set","visited","currentNumber","current_tag","Tag","result","filter","i0","ɵɵdirectiveInject","i1","HttpClient","selectors","inputs","chosenFunction","outputs","decls","vars","consts","template","FileSelectComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd"],"sources":["C:\\Users\\macse\\Downloads\\ZipProject\\src\\app\\file-select\\file-select.component.ts","C:\\Users\\macse\\Downloads\\ZipProject\\src\\app\\file-select\\file-select.component.html"],"sourcesContent":["import { Component, Input, OnInit, Output, EventEmitter, ViewChild} from '@angular/core';\nimport { read, utils, write, writeFile } from 'xlsx';\nimport {saveAs} from \"file-saver\"\n//import { FileReader } from '@angular/platform-browser';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, firstValueFrom, take } from 'rxjs';\n//import {google} from \"googleapis\";\n\n\n@Component({\n  selector: 'app-file-select',\n  templateUrl: './file-select.component.html',\n  styleUrls: ['./file-select.component.scss']\n})\nexport class FileSelectComponent implements OnInit{\n  constructor(private http:HttpClient){}\n  ngOnInit() {\n    //this.createExcelFile();\n    \n    if(this.functionName == 'Counter'){\n    this.count()\n    }\n    if(this.functionName == 'Converter'){\n     //read the first column for zip codes \n      //this.createExcelFile()\n      this.convert()\n    }\n    \n  }\n\n  \n\n@Input() fileJSON: any;\n@Input() chosenFunction: any;\n@Input() fileName:string | undefined;\n@Input() functionName:string | undefined;\n\n@Output() sendValue = new EventEmitter<any>();\n\nasync createExcelFile(allZipCodes:string[], dictionary:Map<string, Map<string, number>>):Promise<any>{\n  var wb = utils.book_new();\n    wb.Props = {\n      Title: \"SheetJS Tutorial\",\n      Subject: \"Test\",\n      Author: \"Red Stapler\",\n      CreatedDate: new Date(2017,12,19)\n};\n  wb.SheetNames.push(\"Test Sheet\"); \n  //var ws_data = [['hello' , 'world']]; one row with 2 cells\n  var ws_data = [[\" \",\"Latitude\", \"Longitude\",...this.all_tags]];  \n  //part to add the other rows\n  //console.log(dictionary.get(\"Piggy\")?.get(\"33162\"))\n  for(let i = 0; i<allZipCodes.length;i++){\n  let temp = []\n  temp.push(allZipCodes[i])\n\n    for(let j = 0; j<this.all_tags.length;j++){\n      if(dictionary.get(this.all_tags[j])?.get(allZipCodes[i])){\n    temp.push(dictionary.get(this.all_tags[j])?.get(allZipCodes[i]))\n    }\n    else{\n      temp.push(0)\n    }\n  }\n    if(temp != undefined && temp.length > 1){\n    ws_data.push(temp as string[])\n    }\n}\n\nfor(let k = 1; k<ws_data.length;k++){\n  /* (await firstValueFrom(this.http.get<Observable<any>>(\n    `https://maps.googleapis.com/maps/api/geocode/json?components=country:US|postal_code:${ws_data[k][0]}&key=AIzaSyDmVrgNrMs_hq6tXpXkiqFYb1LRSf9gdxs`\n  ))).subscribe(\n    (data) => {\n      let result = data as unknown as Result\n      ws_data[k].splice(1,0,`${result.results[0].geometry.location.lat} ${result.results[0].geometry.location.lng}`)\n      //temp.push(result.results[0].address_components[0].long_name)\n      ////console.log(result.results[0].geometry.location.lat)\n      //console.log(result.results[0].geometry.location.lng)\n\n    }\n      ) */\n      console.log(\"in here\")\n      console.log(ws_data[k])\n     let temp2:any = await firstValueFrom(this.http.get<Observable<Result>>(\n        `https://maps.googleapis.com/maps/api/geocode/json?components=country:US|postal_code:${ws_data[k][0]}&key=AIzaSyDmVrgNrMs_hq6tXpXkiqFYb1LRSf9gdxs`\n      ))\n      ////console.log(\"5pm\")\n      //if(k == ws_data.length-1) {\n    ////console.log(temp2.results[0].geometry.location)\n    ////console.log(temp2) \n    if (temp2.status != 'ZERO_RESULTS') {\n      ws_data[k].splice(1,0,`${temp2.results[0].geometry.location.lat}`)\n      ws_data[k].splice(2,0,`${temp2.results[0].geometry.location.lng}`)\n\n    }\n    else{\n      ws_data[k].splice(1,0, \"Not found\")\n      ws_data[k].splice(2,0, \"Not found\")\n\n\n    }\n}\n\n////console.log(\"outside loop now\")\n\n  //will need an array for each zip code\n  //to make each array, will need to create [], then push\n  //zip code, then push dict.get(tag).get(zip) for every tag\n  var ws = utils.aoa_to_sheet(ws_data);\n  wb.Sheets[\"Test Sheet\"] = ws;\n  var wbout = write(wb, {bookType:'xlsx',  type: 'binary'});\n  function s2ab(s: string) { \n    var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer\n    var view = new Uint8Array(buf);  //create uint8array as viewer\n    for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet\n    return buf;    \n}\n\n  saveAs(new Blob([s2ab(wbout)],{type:\"application/octet-stream\"}), `${this.fileName}.xlsx`);\n\n}\n\ntestFunction(mapping:any){\n  this.sendValue.emit(mapping)\n}\n\n//d = new Map<string, string>();\n\nall_tags:string[] = [\n  \"Piggy\",\"Yoga\",\"PAWS\",\"Dirt\",\"Lighthouse\",\"Art\",\"Block\",\"Storytime\",\"Scavenger\",\"Smoke\",\n\"Underliner\",\"Colors\",\"Com\",\"Shen\",\"Gratitude\",\"Seuss\",\"Fam\",\"Marcus\",\"Zumba\",\"Cage\",\"Cinderfit\",\"Walk4\",\n\"Cocktails\",\"Not\",\"Global\",\"GMD\",\"Jr\",\"Halloween\",\"Typoe\",\"Bootleg\",\"MLK\",\"Public\"\n]\n\nzipIsBad(word:string):Boolean{\n/*Bad if\nNo Dash:\nNot 5 characters\nNot numeric\n\nWith Dash:\nNot 5 characters before and after dash\n\n*/\n\nif(word.includes(\"-\")){\n  let dashIndex:number = word.indexOf(\"-\");\n  let firstPart = word.substring(0,dashIndex)\n  let secondPart = word.substring(dashIndex+1)\n  if(firstPart.length != 5 || secondPart.length != 5\n    || Number.isNaN(Number(firstPart)) ||\n     Number.isNaN(Number(secondPart)) ){\n      return false\n     }\n     return true\n}\n\nif(Number.isNaN(Number(word)) ||\nword.length != 5){\nreturn false\n}\nreturn true\n}\n\n/* async callCountWait(){\n  //console.log(\"In here\")\n  await this.callCountAsync();\n  //console.log(this.d)\n} */\ncallCountAsync(){\n  return new Promise(() => this.count()\n  )\n}\n\ncsvExport(file:any) {\n  const headings = [['Col1', 'Col2', 'Col3']];\n  const wb = utils.book_new();\n  const ws: any = utils.json_to_sheet ( []);\n  utils.sheet_add_aoa (ws, headings);\n  utils. sheet_add_json (ws, file, {\n  \n  origin: 'A2',\n  skipHeader: true,\n  });\n  utils.book_append_sheet (wb, ws, 'Users');\n  writeFile(wb, 'Users Report.xlsx');\n\n  }\n\n  async convert(){\n  //need all the zip codes\n  console.log(this.fileJSON)\n  console.log(typeof this.fileJSON[0])\n  console.log(Array(this.fileJSON[0]))\n  \n  for(let i = 0; i<this.fileJSON.length;i++){\n    let temp2:any = await firstValueFrom(this.http.get<Observable<Result>>(\n      `https://maps.googleapis.com/maps/api/geocode/json?components=country:US|postal_code:${this.fileJSON[i][' ']}&key=AIzaSyDmVrgNrMs_hq6tXpXkiqFYb1LRSf9gdxs`\n    ))\n    let latitude = 'NA'\n      let longitude = 'NA'\n    if (temp2.status != 'ZERO_RESULTS') {\n    latitude = temp2.results[0].geometry.location.lat\n    longitude = temp2.results[0].geometry.location.lng\n    }\n    \n    let temp = {\n      ZIP:this.fileJSON[i][' '],\n      Latitude:latitude,\n      Longitude:longitude,\n      Piggy:this.fileJSON[i]['Piggy'],\n      Yoga:this.fileJSON[i]['Yoga'],\n      PAWS:this.fileJSON[i]['PAWS'],\n      Dirt:this.fileJSON[i]['Dirt'],\n      Lighthouse:this.fileJSON[i]['Lighthouse'],\n      Art:this.fileJSON[i]['Art'],\n      Block:this.fileJSON[i]['Block'],\n      Storytime:this.fileJSON[i]['Storytime'],\n      Scavenger:this.fileJSON[i]['Scavenger'],\n      Smoke:this.fileJSON[i]['Smoke'],\n  Underliner:this.fileJSON[i]['Underliner'],\n  Colors:this.fileJSON[i]['Colors'],\n  Com:this.fileJSON[i]['Com'],\n  Shen:this.fileJSON[i]['Shen'],\n  Gratitude:this.fileJSON[i]['Gratitude'],\n  Seuss:this.fileJSON[i]['Seuss'],\n  Fam:this.fileJSON[i]['Fam'],\n  Marcus:this.fileJSON[i]['Marcus'],\n  Zumba:this.fileJSON[i]['Zumba'],\n  Cage:this.fileJSON[i]['Cage'],\n  Cinderfit:this.fileJSON[i]['Cinderfit'],\n  Walk4:this.fileJSON[i]['Walk4'],\n  Cocktails:this.fileJSON[i]['Cocktails'],\n  Not:this.fileJSON[i]['Not'],\n  Global:this.fileJSON[i]['Global'],\n  GMD:this.fileJSON[i]['GMD'],\n  Jr:this.fileJSON[i]['Jr'],\n  Halloween:this.fileJSON[i]['Halloween'],\n  Typoe:this.fileJSON[i]['Typoe'],\n  Bootleg:this.fileJSON[i]['Bootleg'],\n  MLK:this.fileJSON[i]['MLK'],\n  Public:this.fileJSON[i]['Public']\n    }\n    this.fileJSON[i] = temp\n  }\n\n  let worksheet = utils.json_to_sheet(this.fileJSON)\n  let workbook = utils.book_new()\n  utils.book_append_sheet(workbook, worksheet)\n  writeFile(workbook, `${this.fileName}.xlsx`)\n  console.log(this.fileJSON)\n  /* let allZipCodes:string[] = []\n  for(let i =0; i<this.fileJSON.length;i++){\n    if(!allZipCodes.includes(this.fileJSON[i][' '])){\n    allZipCodes.push(this.fileJSON[i][' '])\n    }\n  }\n  //need to make a dictionary from cells\n  //(0 if undefined)\n  let d = new Map<string, Map<string, number>>()\n  let m;\n  for(let j = 0;j<this.all_tags.length;j++){\n    m = new Map<string, number>()\n    ////console.log(this.all_tags.length)\n    for(let k = 0;k<allZipCodes.length;k++){\n      m.set(String(this.fileJSON[k]['ZIP']), 0)\n    }\n  \n    d.set(this.all_tags[j], m)\n  }   */\n}\ncount(){\n/*\nNeed to change\nRight now, Zips only appear if >=1\nNeed the 0s as well\nWhen starting, loop through whole file to\nget all zip codes, create a list of that\nand reference it in this function\n(loop over that list instead of doing\n  .get().get())\n\n*/\n\n/*\nHave a list of visited tags\nFor every item in the JSON file\nIf the tag-ZIP pair is already in visited, increase by 1\nOtherwise, set to 1\n\n*/\n\n//currently creates dictionary of dictionaries\n//Tag: <ZIP:number of tag-zip occurrences>\n//still need to make it skip undefined zip codes\n\n\n//all the tags from the MasterList\n//Piggy,Yoga,PAWS,Dirt,Lighthouse,Art,Block,Storytime,Scavenger,Smoke,\n//Underliner,Colors,Com,Shen,Gratitude,Seuss,Fam,Marcus,Zumba,Cage,Cinderfit,Walk4,\n//Cocktails,Not,Global,GMD,Jr,Halloween,Typoe,Bootleg,MLK,Public\n\nlet allZipCodes:string[] = [];\nfor(let i = 0;i<this.fileJSON.length;i++){\n  if(allZipCodes.includes(String(this.fileJSON[i]['ZIP']))){\n    continue\n  }\n\n  //console.log(this.fileJSON[i]['ZIP'])\n  allZipCodes.push(String(this.fileJSON[i]['ZIP']))\n}\n\n\n//initialize everything in d here\nlet d = new Map<string, Map<string, number>>()\nlet m;\nfor(let j = 0;j<this.all_tags.length;j++){\n  m = new Map<string, number>()\n  ////console.log(this.all_tags.length)\n  for(let k = 0;k<allZipCodes.length;k++){\n    m.set(String(this.fileJSON[k]['ZIP']), 0)\n  }\n\n  d.set(this.all_tags[j], m)\n}\n////console.log(d)\n\n\nlet visited: any[] = []\nlet currentNumber:number|undefined;\nlet current_tag:string;\n\nfor(let i:number = 0;i<this.fileJSON.length;i++){\n\n  ////console.log(this.fileJSON[i]['Tag'])\n  if(typeof this.fileJSON[i].Tag === 'string'){\n  let result = this.all_tags.filter((word)=>this.fileJSON[i]['Tag'].includes(word))\n  //add a result[0] and if result.length here\n  if(result.length){\n  current_tag = result[0];\n  currentNumber = d.get(current_tag)?.get(String(this.fileJSON[i]['ZIP']) )\n  ////console.log(currentNumber)\n  \n  if(currentNumber !== undefined){\n  d.get(current_tag)?.set(String(this.fileJSON[i]['ZIP']),currentNumber+1)\n  }\n  }\n}\n\n\n}\nthis.createExcelFile(allZipCodes, d)\n\n\n//this.testFunction(d)\n\n//this.csvExport(d)\n\n}\n\n\n}\n\n\n\ninterface Result{\n  results: [\n      {\n          address_components: [\n              {\n                  long_name: number,\n                  short_name: number,\n                  types: [\n                      street_number:string,\n                  ]\n              },\n              {\n                  long_name: string,\n                  short_name: string,\n                  types: [\n                      route:string\n                  ]\n              },\n              {\n                  long_name: string,\n                  short_name: string,\n                  types: [\n                      locality:string,\n                      political:string\n                  ]\n              },\n              {\n                  long_name: string,\n                  short_name: string,\n                  types: string[]\n              },\n              {\n                  long_name: string,\n                  short_name: string,\n                  types: string[]\n              },\n              {\n                  long_name: string,\n                  short_name: string,\n                  types:string []\n              },\n              {\n                  long_name: number,\n                  short_name: number,\n                  types: any[]\n              }\n          ],\n          formatted_address: string,\n          geometry: {\n              location: {\n                  lat: number,\n                  lng: number\n              },\n              location_type: string,\n              viewport: {\n                  northeast: {\n                      lat: number,\n                      lng: number\n                  },\n                  southwest: {\n                      lat: number,\n                      lng: number\n                  }\n              }\n          },\n          place_id: string,\n          plus_code: {\n              compound_code: string,\n              global_code:string\n          },\n          types: any[]\n      }\n  ],\n  status:string,\n}","<p class=\"text-red-50\">Hello</p>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}